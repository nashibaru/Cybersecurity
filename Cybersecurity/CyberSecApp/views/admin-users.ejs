<%- include('layout') %>

<h2>Użytkownicy</h2>
<% if (message) { %><div style="color:green"><%= message %></div><% } %>

<table border="1" cellpadding="4">
  <tr><th>ID</th><th>Login</th><th>Imię</th><th>Rola</th><th>Zablokowane</th><th>Akcje</th></tr>
  <% users.forEach(u => { %>
    <tr>
      <td><%= u.id %></td>
      <td><%= u.username %></td>
      <td><%= u.full_name %></td>
      <td><%= u.role %></td>
      <td><%= u.blocked %></td>
      <td>
        <form method="post" action="/admin/users/<%= u.id %>/block" style="display:inline">
          <button type="submit"><%= u.blocked ? 'Odblokuj' : 'Zablokuj' %></button>
        </form>
        <form method="get" action="/admin/users/<%= u.id %>/edit" style="display:inline">
            <button type="submit">Edytuj</button>
          </form>
        <form method="post" action="/admin/users/<%= u.id %>/delete" style="display:inline" onsubmit="return confirm('Usunąć?')">
          <button type="submit">Usuń</button>
        </form>
      </td>
    </tr>
  <% }) %>
</table>

<h3>Dodaj użytkownika</h3>
<form method="post" action="/admin/users/add">
  <div><label>Nazwa: <input name="username" required /></label></div>
  <div><label>Pełna nazwa: <input name="full_name" /></label></div>
  <div><label>Rola: <select name="role"><option>USER</option><option>ADMIN</option></select></label></div>
  <div><label>Tymczasowe hasło: <input name="temp_password" type="password" required /></label></div>
  <button type="submit">Dodaj</button>
</form>

<p><a href="/admin/settings">Powrót do ustawień</a></p>
<p><a href="/logout">Wyloguj</a></p>

<%- include('footer') %>